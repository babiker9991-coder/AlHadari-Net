<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø­Ø¶Ø±ÙŠ Ù†Øª Ø±ÙŠØ§Ø¶Ø©</title>
<style>
body { font-family:'Segoe UI', Tahoma, sans-serif; margin:0; padding:0; background:#f0f2f5; }
header { background: linear-gradient(90deg,#003366,#0055aa); color:white; padding:25px; font-size:30px; text-align:center; font-weight:bold; letter-spacing:1px; }
nav { background:#0055aa; padding:14px; text-align:center; }
nav a { color:white; margin:0 15px; text-decoration:none; font-weight:bold; font-size:16px; transition:0.3s; }
nav a:hover { text-decoration:underline; color:#ffdd00; }
section { display:none; margin:25px auto; max-width:1000px; background:white; border-radius:15px; padding:25px; box-shadow:0 4px 20px rgba(0,0,0,0.12);}
section.active { display:block; }
input, textarea { width:95%; padding:12px; margin:10px 0; border:1px solid #ccc; border-radius:10px; font-size:16px; }
button { background:#003366; color:white; border:none; padding:12px 20px; border-radius:10px; cursor:pointer; font-size:16px; margin-top:10px; transition:0.3s; }
button:hover { background:#0055aa; }
.news-item { border-bottom:1px solid #ddd; margin-bottom:20px; padding-bottom:15px; text-align:right; border-radius:12px; transition:0.3s; background:#fafafa; }
.news-item:hover { box-shadow:0 6px 18px rgba(0,0,0,0.15); }
.news-item h3 { color:#003366; font-size:22px; margin-bottom:8px; }
.news-item p { font-size:16px; line-height:1.5; color:#333; }
.news-item img { max-width:100%; border-radius:12px; margin-top:10px; }
.like-btn { cursor:pointer; color:#888; font-size:18px; margin-right:10px; transition:0.3s; }
.liked { color:red; font-weight:bold; }
.comment { margin-top:8px; border-top:1px dashed #ccc; padding-top:8px; font-size:15px; color:#555; }
.comment-section { margin-top:12px; }
.comment-section input { width:70%; display:inline-block; }
.comment-section button { width:25%; display:inline-block; }
.success { color:green; }
.error { color:red; }
#contact-us { margin-top:25px; padding:15px; background:#e6f0ff; border-radius:10px; }
footer { margin-top:40px; background:#003366; color:#ccc; padding:16px; font-size:15px; text-align:center; letter-spacing:0.5px; }
</style>
</head>
<body>

<header>ğŸ† Ø§Ù„Ø­Ø¶Ø±ÙŠ Ù†Øª Ø±ÙŠØ§Ø¶Ø©</header>

<nav>
  <a href="#" onclick="showSection('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="#" id="dashboard-link" onclick="showSection('dashboard')" style="display:none;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
</nav>

<section id="home" class="active">
  <h2 style="color:#0055aa; margin-bottom:20px;">Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</h2>
  <div id="news-list"></div>
  <div id="contact-us">
    <h3>ğŸ“¬ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
    <p>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: <a href="mailto:babiker9991@gmail.com">babiker9991@gmail.com</a></p>
    <p>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„: +249900599203</p>
    <p>ØªØ§Ø¨Ø¹Ù†Ø§ Ø¹Ù„Ù‰ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</p>
  </div>
</section>

<section id="dashboard">
  <h2 style="color:#0055aa; margin-bottom:15px;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h2>
  <input type="text" id="newsTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¨Ø±"><br>
  <textarea id="newsContent" rows="5" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø¨Ø±"></textarea><br>
  <input type="text" id="newsImage" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"><br>
  <button onclick="addNews()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¨Ø±</button>
  <p id="dashboardMsg"></p>
</section>

<footer>
  &copy; 2025 Ø§Ù„Ø­Ø¶Ø±ÙŠ Ù†Øª Ø±ÙŠØ§Ø¶Ø© | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDxoEJLaGcEy7s1P2nE2_bDniS71ldI31Q",
  authDomain: "alhadari-net.firebaseapp.com",
  projectId: "alhadari-net",
  storageBucket: "alhadari-net.firebasestorage.app",
  messagingSenderId: "465757130283",
  appId: "1:465757130283:web:2ee9d5a6ceaf63af5e246e",
  measurementId: "G-DK4L0CDHY4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth();
const provider = new GoogleAuthProvider();

// ************ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ø´Ø±Ù ************
const adminPassword = "221133";
let isAdmin = false;

window.onload = function(){
  const pwd = prompt("Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø´Ø±Ù Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø§ØªØ±Ùƒ ÙØ§Ø±Øº Ù„Ù„Ø²ÙˆØ§Ø±):");
  if(pwd === adminPassword){
    isAdmin = true;
    document.getElementById("dashboard-link").style.display = "inline-block";
    showSection('dashboard');
  } else {
    showSection('home'); 
  }
}

// Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
window.showSection = function(id){
  const sections = document.querySelectorAll("section");
  sections.forEach(sec => sec.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if(id==="home"){ loadNews(); }
}

// Ø¥Ø¶Ø§ÙØ© Ø®Ø¨Ø± Ø¬Ø¯ÙŠØ¯
window.addNews = async function(){
  const title = document.getElementById("newsTitle").value;
  const content = document.getElementById("newsContent").value;
  const image = document.getElementById("newsImage").value;
  const msg = document.getElementById("dashboardMsg");

  if(!title || !content){ msg.textContent="âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰"; msg.className="error"; return; }

  try{
    await addDoc(collection(db,"sportsNews"),{
      title, content, image, likes:0, createdAt:new Date()
    });
    msg.textContent="âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¨Ø± Ø¨Ù†Ø¬Ø§Ø­!";
    msg.className="success";
    document.getElementById("newsTitle").value="";
    document.getElementById("newsContent").value="";
    document.getElementById("newsImage").value="";
    loadNews();
  }catch(e){
    console.error(e);
    msg.textContent="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¨Ø±";
    msg.className="error";
  }
}

// ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø± Ø¹Ø¨Ø± Google
let currentUserEmail = "Ø²Ø§Ø¦Ø±";
async function loginUser(){
  try{ await signInWithPopup(auth, provider); }catch(e){ console.error(e); }
}

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
onAuthStateChanged(auth, (user)=>{
  if(user){ currentUserEmail = user.email; } else { currentUserEmail = "Ø²Ø§Ø¦Ø±"; }
});

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±
async function loadNews(){
  const newsDiv = document.getElementById("news-list");
  newsDiv.innerHTML = "";
  try{
    const q = query(collection(db,"sportsNews"), orderBy("createdAt","desc"));
    const snapshot = await getDocs(q);
    snapshot.forEach(docSnap=>{
      const data = docSnap.data();
      const newsId = docSnap.id;
      const newsItem = document.createElement("div");
      newsItem.className="news-item";

      let html = `<h3>${data.title}</h3>
                  <p>${data.content}</p>
                  ${data.image? `<img src="${data.image}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø®Ø¨Ø±">` : ''}
                  <p><span class="like-btn ${data.likes>0?'liked':''}" onclick="likeNews('${newsId}',this)">â¤ï¸ ${data.likes}</span></p>
                  <div class="comment-section">
                    <input type="text" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§" id="comment-${newsId}">
                    <button onclick="addComment('${newsId}')">Ø£Ø±Ø³Ù„</button>
                    <div id="comments-${newsId}"></div>
                  </div>
                  <small>ğŸ“… ${data.createdAt.toDate().toLocaleString()}</small>`;
      newsItem.innerHTML = html;
      newsDiv.appendChild(newsItem);
      loadComments(newsId);
    });
  }catch(e){
    console.error(e);
    newsDiv.innerHTML = "<p>âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</p>";
  }
}

// Ø¥Ø¹Ø¬Ø§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¨Ø±
window.likeNews = async function(newsId, el){
  try{
    const newsRef = doc(db,"sportsNews",newsId);
    const currentLikes = parseInt(el.textContent.replace("â¤ï¸","")) || 0;
    await updateDoc(newsRef, { likes: currentLikes + 1 });
    el.textContent = `â¤ï¸ ${currentLikes +1}`;
    el.classList.add("liked");
  }catch(e){ console.error(e); }
}

// Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚ Ø¨Ø§Ø³Ù… Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
window.addComment = async function(newsId){
  const input = document.getElementById(`comment-${newsId}`);
  const text = input.value.trim();
  if(!text) return;
  try{
    await addDoc(collection(db,"sportsNews",newsId,"comments"),{
      name: currentUserEmail,
      comment:text,
      createdAt:new Date()
    });
    input.value="";
    loadComments(newsId);
  }catch(e){ console.error(e); }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
async function loadComments(newsId){
  const commentsDiv = document.getElementById(`comments-${newsId}`);
  commentsDiv.innerHTML="";
  try{
    const snapshot = await getDocs(collection(db,"sportsNews",newsId,"comments"));
    snapshot.forEach(docSnap=>{
      const data = docSnap.data();
      const p = document.createElement("p");
      p.className="comment";
      p.textContent = `${data.name}: ${data.comment} - ${data.createdAt.toDate().toLocaleString()}`;
      commentsDiv.appendChild(p);
    });
  }catch(e){ console.error(e); }
}
</script>
</body>
</html>
